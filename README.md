# ğŸ§  CeloMÎ”IND Web Interface

A modern, responsive web interface for the CeloMÎ”IND AI-powered DeFi interface on the Celo blockchain.

## ğŸŒŸ Features

- ğŸ’¬ Natural language AI chat interface for DeFi operations
- ğŸ‘› External wallet support with secure transaction handling
- ğŸ”„ Real-time transaction monitoring and status tracking
- ğŸ’° Real-time wallet balance tracking with USD conversion
- ğŸŒ“ Light/Dark theme toggle with system preference detection
- ğŸ“± Responsive design for desktop and mobile devices
- ğŸ”’ Direct blockchain connection for verification
- âš¡ Integration with multiple DeFi protocols (AAVE, ICHI, Mento)
- ğŸ›¡ï¸ Enhanced security with no stored private keys
- ğŸ”Œ Network validation and automatic Celo network switching

## ğŸš€ Getting Started

### Prerequisites

- Node.js v16+ and npm v7+
- CeloMÎ”IND backend API running and accessible
- Web browser with JavaScript enabled
- Browser extension wallet (MetaMask, Rabby, etc.) for blockchain transactions

### Installation

```bash
# Clone both repositories
git clone https://github.com/0xOucan/celo-mind-dn.git
git clone https://github.com/0xOucan/celo-mind-web.git

# Use the launch script to start both services
cp celo-mind-dn/launch.sh ./
chmod +x launch.sh
./launch.sh
```

The launch script automatically:
1. Installs dependencies for both repositories
2. Starts the backend API server
3. Starts the frontend development server
4. Connects them together with proper configuration

### Configuration

The application requires the following environment variables:

```
# API endpoint for the CeloMÎ”IND backend
VITE_API_URL=http://localhost:4000

# Celoscan explorer URL for transaction links
VITE_CELO_EXPLORER_URL=https://celoscan.io

# Privy App ID for wallet integration
VITE_PRIVY_APP_ID=your_privy_app_id
```

## ğŸ”Œ Backend Integration

This web interface connects to the [CeloMÎ”IND backend API](https://github.com/0xOucan/celo-mind-dn) to process commands and execute blockchain operations.

### Communication Flow

1. **User Interface**: The web frontend collects user inputs through a conversational interface
2. **API Requests**: Frontend sends natural language commands to the `/api/agent/chat` endpoint
3. **AI Processing**: Backend processes commands using advanced AI and Agent Orchestration
4. **Blockchain Operations**: Backend creates transaction requests for the frontend wallet to sign
5. **Transaction Handling**: Frontend monitors and processes pending transactions with the connected wallet
6. **Response Handling**: Frontend displays results and updates wallet balances

### Wallet Integration

CeloMÎ”IND supports external wallets through the Privy integration:

- **Wallet Connection**: Connect any EIP-1193 compatible wallet (MetaMask, Rabby, etc.)
- **Transaction Signing**: Transactions generated by the AI are sent to your wallet for signing
- **Transaction Monitoring**: Monitor transaction status in real-time through the UI
- **Wallet Balances**: View your wallet's token balances and total portfolio value
- **Network Switching**: Automatic Celo network detection and switching
- **Security**: No private keys stored in the application or backend

## ğŸ“‚ Project Structure

```
celo-mind-web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # React UI components
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx # AI chat interface
â”‚   â”‚   â”œâ”€â”€ Header.tsx        # Application header
â”‚   â”‚   â”œâ”€â”€ Icons.tsx         # SVG icon components
â”‚   â”‚   â”œâ”€â”€ InfoPanel.tsx     # Welcome/information panel
â”‚   â”‚   â”œâ”€â”€ WalletBalances.tsx # Wallet balance display
â”‚   â”‚   â”œâ”€â”€ WalletConnect.tsx  # Wallet connection component
â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx    # Layout wrapper with dark mode support
â”‚   â”‚   â””â”€â”€ TransactionMonitor.tsx # Transaction monitoring UI
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ PrivyProvider.tsx  # Privy wallet provider integration
â”‚   â”‚   â””â”€â”€ WalletContext.tsx  # Wallet state management
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ agentService.ts    # Agent API communication
â”‚   â”‚   â”œâ”€â”€ blockchainService.ts # Blockchain connection services
â”‚   â”‚   â””â”€â”€ transactionService.ts # Transaction handling and processing
â”‚   â”œâ”€â”€ App.tsx               # Main application component
â”‚   â”œâ”€â”€ config.ts             # Application configuration
â”‚   â”œâ”€â”€ index.css             # Global CSS
â”‚   â””â”€â”€ main.tsx              # Application entry point
â”œâ”€â”€ index.html                # HTML template
â”œâ”€â”€ package.json              # Project dependencies and scripts
â”œâ”€â”€ postcss.config.js         # PostCSS configuration
â”œâ”€â”€ tailwind.config.js        # Tailwind CSS configuration
â”œâ”€â”€ tsconfig.json             # TypeScript configuration
â””â”€â”€ vite.config.ts            # Vite bundler configuration
```

## ğŸ§© Key Components

### 1. WalletContext
The central wallet management system provides:
- Wallet connection state management
- Backend synchronization
- Address tracking and formatting
- Integration with Privy authentication

### 2. TransactionMonitor
Monitors and processes transactions by:
- Polling for pending transactions
- Creating wallet clients for signing
- Network validation and switching
- Transaction status tracking
- Error handling with helpful messages

### 3. WalletBalances
Real-time balance tracking with:
- Direct blockchain data fetching with viem
- USD conversion with market prices
- Visual indicators for token types
- One-click refresh functionality
- CeloScan integration for verification

### 4. ChatInterface
Intelligent conversation interface with:
- Message history tracking
- Stream-based response handling
- Transaction status updates
- Response formatting and error handling
- Pre-checks for wallet connection

## ğŸŒ Running the Complete Stack

For the best experience, run both the frontend and backend together:

```bash
# Start both servers using the launch script
./launch.sh
```

This will start:
- Backend API server at http://localhost:4000
- Frontend development server at http://localhost:5173

## ğŸš¢ Proof-of-Ship Improvements

We've implemented all the major recommendations from the [Celo Proof-of-Ship report](https://github.com/celo-org/Proof-of-Ship/blob/main/2/reports/projects/CeloMind.md) to significantly enhance the security, code quality, and architecture of our application:

### Security Enhancements
- âœ… **Eliminated Private Key Storage**: Removed all private keys from .env files and implemented a secure wallet connection system that keeps keys in your browser wallet
- âœ… **Browser Extension Integration**: Integrated with browser wallets (MetaMask, Rabby, etc.) that handle transaction signing without exposing private keys
- âœ… **Network Validation**: Added automated network detection and Celo chain switching to ensure transactions always target the correct network
- âœ… **Transaction Monitoring**: Implemented real-time transaction monitoring with detailed status reporting and error recovery
- âœ… **Secure Wallet Providers**: Used Privy's security framework for wallet interactions to implement industry best practices
- âœ… **Smart Contract Interaction Review**: Ensured all contract interactions follow recommended security patterns

### Code Quality Improvements
- âœ… **Comprehensive Error Handling**: Implemented robust error handling throughout the application with specific error types and helpful user messages
- âœ… **Modular Component Structure**: Refactored complex components into smaller, more manageable units with clear responsibilities
- âœ… **TypeScript Type Safety**: Replaced `any` types with explicit interface definitions and type guards to improve type safety
- âœ… **Rate Limiting and Protection**: Added rate limiting for API calls to prevent denial-of-service attacks
- âœ… **Code Style Consistency**: Implemented consistent coding standards with ESLint and Prettier
- âœ… **Magic Numbers Elimination**: Replaced magic numbers with named constants for better readability and maintenance
- âœ… **Function Complexity Reduction**: Split complex functions into smaller, more focused units to improve readability and testability

### Architecture Enhancements
- âœ… **Agent Caching**: Implemented agent caching to improve performance and reduce unnecessary computations
- âœ… **Service-Based Architecture**: Established a clean separation between services and UI components with well-defined interfaces
- âœ… **Improved State Management**: Implemented context-based wallet and transaction state management with predictable data flow
- âœ… **Launch Script**: Created a comprehensive launch script that simplifies development environment setup
- âœ… **Centralized Logging**: Implemented a centralized logging system with different severity levels for better debugging
- âœ… **Dependency Injection**: Applied dependency injection patterns to improve testability and component isolation
- âœ… **Loading State Management**: Added proper loading states for all asynchronous operations to improve user experience

### Testing Improvements
- âœ… **Unit Test Framework**: Added Jest testing framework with test configuration
- âœ… **Core Component Tests**: Implemented unit tests for core components and critical functions
- âœ… **Mock Services**: Created mock services for testing components in isolation
- âœ… **Error Case Tests**: Added specific tests for error conditions and edge cases

## ğŸ” Security Considerations

The CeloMÎ”IND web interface implements several security best practices:

- **No Private Key Storage**: Private keys never leave your wallet - all transactions require explicit approval
- **Secure Wallet Connections**: Implemented via Privy integration with industry-standard security
- **Transaction Verification**: All transactions include clear information about what you're approving
- **Network Validation**: Automatic verification that you're connected to the Celo network before transactions
- **Session-Based Authentication**: Wallet connections persist only for the current session
- **Transaction Monitoring**: Complete visibility into all pending and processed transactions
- **Error Handling**: Comprehensive error handling prevents security issues from failed operations
- **Data Validation**: All inputs are validated before processing to prevent injection attacks
- **Rate Limiting**: API endpoints implement rate limiting to prevent abuse

## ğŸ”„ Transaction Handling

CeloMÎ”IND implements a robust transaction system:

1. **AI-Generated Transactions**: The AI agent creates transaction requests based on your commands
2. **Transaction Queue**: Transactions are queued for wallet signature
3. **Wallet Signing**: Your connected wallet receives the transaction for approval
4. **Status Monitoring**: Monitor transaction status in real-time in the UI
5. **Transaction History**: View completed and pending transactions

## ğŸ‘¨â€ğŸ’» Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ”— Related Projects

- [CeloMÎ”IND Backend (DN)](https://github.com/0xOucan/celo-mind-dn) - AI agent backend for Celo DeFi operations

## ğŸ“§ Contact

- Twitter: [@0xoucan](https://x.com/0xoucan)

## ğŸ“„ License

This project is licensed under the MIT License.
